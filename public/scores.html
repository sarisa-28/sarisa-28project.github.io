<!--public/scores.html-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Player Scores</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #1e1e2f;
            color: #ffffff;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1 {
            margin-top: 20px;
            color: yellow;
        }

         /* ‡πÅ‡∏ñ‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡∏Ç‡πâ‡∏≤‡∏á‡∏ö‡∏ô */
         #top-menu {
            background: linear-gradient(45deg, #ff7e5f, #feb47b);
            color: white;
            padding: 10px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            position: sticky;
            top: 1%;
            z-index: 100;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            animation: gradient-animation 6s ease infinite;
            border-bottom: 5px solid cyan;
            box-shadow: 0 0 20px cyan;
        }

        #top-menu a {
            color: white;
            text-decoration: none;
            font-size: 18px;
            margin: 0 15px;
            padding: 10px;
            border-radius: 5px;
            transition: background-color 0.3s ease, transform 0.3s ease;
        }

        #top-menu a:hover {
            background-color: #ff6f61;
            transform: scale(1.1);
            box-shadow: 0 0 15px cyan;
        }

        #scores-table {
            width: 80%;
            border-collapse: collapse;
            margin-top: 20px;
            background: #2e2e3e;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 0 15px cyan;
        }

        #scores-table th, #scores-table td {
            padding: 10px;
            text-align: center;
            border: 1px solid #444;
        }

        #scores-table th {
            background: #444;
        }

        #scores-table td {
            background: #555;
        }

        #back-button {
            margin: 20px;
            padding: 10px 20px;
            font-size: 16px;
            color: #fff;
            background: #ff6347;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        #back-button:hover {
            background: #ff4500;
        }

        .search-bar {
            margin-top: 20px;
            width: 30%;
            padding: 10px;
            font-size: 16px;
            border: none;
            border-radius: 5px;
            background-color: #555;
            color: #ffffff;
        }

        .search-container {
            display: flex;
            justify-content: space-around;
            width: 80%;
        }
        /* ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß‡πÉ‡∏´‡πâ gradient */
        @keyframes gradient-animation {
    0%, 100% {
        background: linear-gradient(45deg, #0f2027, #203a43, #2c5364); /* ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏°‡πÑ‡∏õ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô */
    }
    50% {
        background: linear-gradient(45deg, #232526, #414345, #485563); /* ‡∏î‡∏≥‡πÄ‡∏Ç‡πâ‡∏°‡πÑ‡∏õ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô */
    }
}

    </style>
</head>
<body>
        <!-- ‡πÅ‡∏ñ‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡∏Ç‡πâ‡∏≤‡∏á‡∏ö‡∏ô -->
        <div id="top-menu">
            <a href="start.html"><i class="fa-solid fas fa-play fa-bounce" style="--fa-bounce-start-scale-x: 1; --fa-bounce-start-scale-y: 1; --fa-bounce-jump-scale-x: 1; --fa-bounce-jump-scale-y: 1; --fa-bounce-land-scale-x: 1; --fa-bounce-land-scale-y: 1; color: cyan;"></i> Start</a>
            <a href="addquestion.html">ü§îAdd Questionsüí≠</a>
            <a href="roomcode.html"><i class="fas fa-key fa-solid fa-flip"  style="--fa-animation-duration: 3s; color: cyan;"></i> Set Room Code</a>  
            <a href="seeroom.html">üö©View Room CodesüëÄ</a> 
            <a href="scores.html"><i class="fas fa-trophy fa-beat" style="color: cyan;"></i> View Scores</a>
            <a href="historyroomcode.html">üëëHistory RoomCodeüè∞</a>
            <a href="setting.html"><i class="fas fa-cog fa-pulse" style="color: cyan;"></i> Setting</a>
            <a href="evaluation.html">üôáüèª Evaluation üôáüèª‚Äç‚ôÄÔ∏è</a>
            <a href="new/newstart.html"><i class="fa-solid fa-globe fa-spin" style="color: cyan;"></i> ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡πÇ‡∏•‡∏Å‡∏ó‡∏µ‡πà 2</a>
            <a href="index.html"><i class="fa-solid fas fa-sign-out-alt fa-shake" style="color: cyan;"></i> Log Out</a>
        </div>
    
    <h1>üéâ Player Scores üéä</h1>
    <div class="search-container">
        <input type="text" id="username-search" class="search-bar" placeholder="Search by Username...">
        <input type="text" id="roomcode-search" class="search-bar" placeholder="Search by Room Code...">
        <input type="date" id="date-search" class="search-bar" placeholder="Search by Date...">
    </div>
    
    <table id="scores-table">
        <thead>
            <tr>
                <th>Name</th>
                <th>Score</th>
                <th>Username</th>
                <th>Room Code</th>
                <th>Date Played</th>
                <th>Time Played</th>
            </tr>
        </thead>
        <tbody>
            <!-- ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
        </tbody>
    </table>

    <button id="back-button">Back To Home</button>

    <audio id="o-sound" src="sounds/o.mp3" preload="auto"></audio>
    <audio id="hoverSound" src="sounds/h.mp3" preload="auto"></audio>
    <iframe src="music.html" style="display: none;"></iframe>

    <script>
        const username = sessionStorage.getItem('username');
        if (username) {
            console.log(`Logged-in Username: ${username}`);
            //document.getElementById('username-display').innerText = username;
        } else {
            console.warn('No username found in sessionStorage');
        }


async function loadScores() {
    try {
        const response = await fetch('/scores');
        const scores = await response.json();
        console.log(scores); // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏î‡∏∂‡∏á‡∏°‡∏≤

        const tbody = document.getElementById('scores-table').querySelector('tbody');
        
        // ‡∏•‡∏π‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤
        scores.forEach(score => {
            const row = document.createElement('tr');
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ã‡∏•‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Name
            const nameCell = document.createElement('td');
            nameCell.innerText = score.name || 'N/A';

            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ã‡∏•‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Score
            const scoreCell = document.createElement('td');
            scoreCell.innerText = score.score || 'N/A';

            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ã‡∏•‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Username
            const usernameCell = document.createElement('td');
            usernameCell.innerText = score.username || 'N/A';

            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ã‡∏•‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Room Code
            const roomCodeCell = document.createElement('td');
            roomCodeCell.innerText = score.roomCode || 'N/A';

            // ‡πÅ‡∏õ‡∏•‡∏á‡∏Ñ‡πà‡∏≤ datePlayed ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢
            const datePlayed = new Date(score.datePlayed);
            const dateCell = document.createElement('td');
            dateCell.innerText = datePlayed.toLocaleDateString('th-TH');  // ‡πÉ‡∏ä‡πâ locale ‡∏Ç‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢

            const timeCell = document.createElement('td');
            timeCell.innerText = datePlayed.toLocaleTimeString('th-TH');  // ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢

            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ã‡∏•‡∏•‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡πÅ‡∏ñ‡∏ß
            row.appendChild(nameCell);
            row.appendChild(scoreCell);
            row.appendChild(usernameCell);
            row.appendChild(roomCodeCell);
            row.appendChild(dateCell);
            row.appendChild(timeCell);

            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ñ‡∏ß‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á
            tbody.appendChild(row);
        });
    } catch (error) {
        console.error('Error fetching scores:', error);
    }
}

        window.onload = loadScores;

        document.getElementById('back-button').addEventListener('click', () => {
            window.location.href = 'start.html';
        });

        function filterScores() {
        const usernameSearch = document.getElementById('username-search').value.toLowerCase();
        const roomCodeSearch = document.getElementById('roomcode-search').value.toLowerCase();
        const dateSearch = document.getElementById('date-search').value;  // ‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
        const rows = document.querySelectorAll('#scores-table tbody tr');

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö dd/mm/yyyy
        function formatDateToTH(date) {
            const d = new Date(date);
            const day = d.getDate();
            const month = d.getMonth() + 1; // ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÉ‡∏ô JavaScript ‡∏à‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏µ‡πà 0
            const year = d.getFullYear() + 543; // ‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏µ ‡∏û.‡∏®.
            return `${day}/${month}/${year}`;
        }

        rows.forEach(row => {
            const username = row.cells[2].innerText.toLowerCase();
            const roomCode = row.cells[3].innerText.toLowerCase();
            const date = row.cells[4].innerText; // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á

            // ‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏°‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á
            const formattedDateSearch = formatDateToTH(dateSearch);

            // ‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
            const matchUsername = username.includes(usernameSearch) || usernameSearch === ''; // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ username ‡∏Å‡πá‡πÉ‡∏´‡πâ‡∏ú‡πà‡∏≤‡∏ô
            const matchRoomCode = roomCode.includes(roomCodeSearch) || roomCodeSearch === ''; // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ roomCode ‡∏Å‡πá‡πÉ‡∏´‡πâ‡∏ú‡πà‡∏≤‡∏ô
            const matchDate = (date === formattedDateSearch) || formattedDateSearch === ''; // ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà

            // ‡∏Å‡∏£‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ï‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
            if (
                (usernameSearch && matchUsername && roomCodeSearch === '' && dateSearch === '') || 
                (roomCodeSearch && matchRoomCode && usernameSearch === '' && dateSearch === '') ||
                (dateSearch && matchDate && usernameSearch === '' && roomCodeSearch === '') || 
                (usernameSearch && roomCodeSearch && matchUsername && matchRoomCode) || 
                (usernameSearch && dateSearch && matchUsername && matchDate) ||
                (roomCodeSearch && dateSearch && matchRoomCode && matchDate) || 
                (usernameSearch && roomCodeSearch && dateSearch && matchUsername && matchRoomCode && matchDate) || 
                (!usernameSearch && !roomCodeSearch && !dateSearch)  // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏•‡∏¢ ‡∏Å‡πá‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏∏‡∏Å‡πÅ‡∏ñ‡∏ß
            ) {
                row.style.display = '';
            } else {
                row.style.display = 'none';
            }
        });
    }

document.getElementById('username-search').addEventListener('input', filterScores);
document.getElementById('roomcode-search').addEventListener('input', filterScores);
document.getElementById('date-search').addEventListener('input', filterScores); // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ü‡∏±‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà

// ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏õ‡∏∏‡πà‡∏°
    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏î‡∏µ‡πÄ‡∏•‡∏¢‡πå
    function playSound(sound) {
        sound.pause();        // ‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
        sound.currentTime = 0; // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÑ‡∏õ‡∏à‡∏∏‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
        sound.play();         // ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
    }

    document.querySelectorAll("#top-menu a").forEach(item => {
    item.addEventListener("mouseenter", () => {
        const hoverSound = document.getElementById("hoverSound");
        if (hoverSound) {
            hoverSound.pause();  // ‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤
            hoverSound.currentTime = 0; // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÑ‡∏õ‡∏à‡∏∏‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
            hoverSound.play().catch(err => console.warn("‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á hover:", err));
        }
    });
});

//‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏µ‡∏¢‡∏á
document.addEventListener("DOMContentLoaded", function() {
        const soundSetting = localStorage.getItem('soundSetting');

        if (soundSetting === 'off') {
            document.querySelectorAll('audio').forEach(audio => {
                audio.muted = true;
            });
        }
    });

        // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡∏≤‡∏ß‡∏ï‡∏Å
        function createMeteor() {
            const meteor = document.createElement('div');
            meteor.classList.add('meteor');
            document.body.appendChild(meteor);
            meteor.style.left = `${Math.random() * 100}vw`;
            meteor.style.animationDuration = `${Math.random() * 5 + 5}s`;
            meteor.style.width = `${Math.random() * 3 + 4}px`;
            meteor.style.height = `${Math.random() * 3 + 4}px`;
            meteor.style.opacity = Math.random() * 0.5 + 0.5;

            setTimeout(() => meteor.remove(), (Math.random() * 5 + 5) * 1000);
        }

        setInterval(createMeteor, 500);
    </script>
</body>
</html>